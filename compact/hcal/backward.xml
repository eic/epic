<!-- SPDX-License-Identifier: LGPL-3.0-or-later -->
<!-- Copyright (C) 2022 Wouter Deconinck, Leszek Kosarzewski, Ryan Milton -->

<lccdd>
  <define>
    <documentation>
      #### Material Thickness
    </documentation>
    <constant name="HcalEndcapNSteelThickness"       value="4.0 * cm"/>
    <constant name="HcalEndcapNPolystyreneThickness" value="0.5 * cm"/>

    <constant name="HcalEndcapN_polyhedron_rmax"     value="275.0*cm"/>
    <constant name="HcalEndcapN_polyhedron_rmin"     value="12.4*cm"/>
    <!--constant name="HcalEndcapN_segments_rmax"     value="HcalEndcapN_polyhedron_rmax/(cos(180*deg/HcalEndcapN_CaloSides))"/-->

    <documentation>
      - Hcal Endcap N Layers and computed Thickness
    </documentation>

    <constant name="HcalEndcapNSingleLayerThickness"
             value="HcalEndcapNSteelThickness + HcalEndcapNPolystyreneThickness"/>
    <constant name="HcalEndcapNLayer_NRepeat" value="floor(HcalEndcapN_length / HcalEndcapNSingleLayerThickness)"/>
    <constant name="HcalEndcapN_thickness" value="HcalEndcapNLayer_NRepeat * HcalEndcapNSingleLayerThickness"/>
  </define>


  <!-- Define detector -->
  <detectors>
    <documentation>
      ### Backwards (Negative Z) Endcap Hadronic Calorimeter
    </documentation>
    <detector
      id="HCalEndcapN_ID"
      name="HcalEndcapN"
      type="epic_PolyhedraEndcapCalorimeter2"
      readout="HcalEndcapNHits"
      vis="RedVis"
      calorimeterType="HAD_ENDCAP" reflect="true">
      <position x="0" y="0" z="0"/>
      <dimensions
        numsides="HcalEndcapN_CaloSides"
        zmin="HcalEndcapN_zmin"
        rmin="HcalEndcapN_polyhedron_rmin"
        rmax="HcalEndcapN_polyhedron_rmax"/>
      <layer repeat="HcalEndcapNLayer_NRepeat" vis="GreyVis">
        <slice material="Steel235" thickness="HcalEndcapNSteelThickness" vis="PurpleVis"/>
        <slice material="Air" thickness="HcalEndcapNPolystyreneThickness" vis="GreenVis" sensitive="yes" limits="cal_limits">
         <tiles material="Polystyrene"
            sensitive="yes"
            eta_values="3.97368, 3.82929, 3.65542, 3.48947, 3.33106, 3.17987, 
            3.03556, 2.89782, 2.76635, 2.64086, 2.52109, 2.40676, 2.29764,
            2.19349, 2.09299, 1.99721, 1.90582, 1.81882, 1.7357, 1.65646, 
            1.58079, 1.50851, 1.43941, 1.3734, 1.3104, 1.25011, 1.19095, 1.1158"
            phi_width="0.10472"
            nbins_eta="27"
            nbins_phi="60"
            vis="HcalSensorVis"
            limits="cal_limits">
          </tiles>
        </slice>
        <!-- slice material="Polystyrene" thickness="HcalEndcapNPolystyreneThickness" vis="HcalSensorVis" sensitive="yes" limits="cal_limits"/ -->
      </layer>
    </detector>
  </detectors>

  <!--  Definition of the readout segmentation/definition  -->
  <readouts>
    <readout name="HcalEndcapNHits">
      <segmentation type="NoSegmentation"/>
      <id>system:8,barrel:3,module:4,layer:8,slice:5,tile:32</id>

    </readout>
  </readouts>

</lccdd>

