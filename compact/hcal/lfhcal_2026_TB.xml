<lccdd>

  <info name="lfhcal_8m_module_only.xml"
        title="EPIC LFHCAL Single 8M Module"
        author="@FriederikeBock"
        url="https://github.com/FriederikeBock"
        status="development"
        version="1.0"
  ><comment/></info>

  <define>
    <include ref="lfhcal/module_definitions.xml"/>
  </define>

  <display>
    <vis name="LFHCAL8MModVis"          ref="AnlBlue"       showDaughters="true"  visible="true"/>
    <vis name="LFHCAL4MModVis"          ref="AnlViolet"     showDaughters="true"  visible="true"/>
    <vis name="LFHCAL8MModOuter"        ref="AnlBlue"       showDaughters="true"  visible="true"/>
    <vis name="LFHCALLayerScintVis"     ref="AnlLight_Gray" showDaughters="false" visible="true"/>
    <vis name="LFHCALLayerSteelVis"     ref="AnlRed"        showDaughters="false" visible="true"/>
    <vis name="LFHCALLayerTungstenVis"  ref="AnlViolet"     showDaughters="false" visible="true"/>
    <vis name="LFHCALLayerKaptonVis"    ref="AnlGold"       showDaughters="false" visible="true"/>
    <vis name="LFHCALLayerFoilVis"      ref="AnlGray"       showDaughters="false" visible="true"/>
    <vis name="LFHCALModPCB"            ref="AnlDarkGreen"  showDaughters="false" visible="true"/>
 </display>

  <!-- Define detector -->
  <detectors>
    <documentation>
      ### Forward (Positive Z) Endcap Hadronic Calorimeter
      Test beam setup 2026

      LFHCal module features 60 layers of Steel/Sc 1.6 cm/0.4 cm
      
      Currently don't have an implementation of electronics, so just leave that area (final 10 cm) empty
      So then, actual detector area is "LFHCAL_length - LFHCALElectronicsThickness" long
    </documentation>
    <detector
      id="LFHCAL_ID"
      name="LFHCAL"
      type="epic_LFHCAL_TestBeam"
      readout="LFHCALHits"
      vis="InvisibleWithDaughters"
      calorimeterType="HAD_ENDCAP"
      renderComponents="1"
      allSensitive="0"
      >

      <position x="0" y="0" z="0"/>
      <dimensions
        z="LFHCAL_length"
        rmin="20*cm"
        rmax="LFHCAL_rmax"
        x="EightM_OuterWidth*2+1*cm"
        y="EightM_OuterHeight*4+1*cm"/>
      <envelope material="Steel235"/>

      <eightmodule name="8MModule" vis="InvisibleWithDaughters" repeat="0" >
        <dimensions
        width="EightM_OuterWidth"
        height="EightM_OuterHeight"
        widthBackInner="EightM_BackInnerWidth"
        heightBackInner="EightM_BackInnerHeight"
        widthSideWall="Mod_SideWallThickness"
        widthTopWall="Mod_TopWallThickness"
        thicknessMountingPlate="Mod_MountingPlateThickness"
        thicknessFrontWall="Mod_FrontWallThickness"
        thicknessBackWall="Mod_BackWallThickness"
        arrayX="EightM_xArr"
        arrayY="EightM_yArr"
        notchDepth="Mod_NotchDepth"
        notchHeight="Mod_NotchHeight"
        foilThick="Mod_FoilThick"
        pcbLength="Mod_PCBLength"
        pcbThick="Mod_PCBThickness"
        pcbWidth="Mod_PCBWidth"
        />
        <position x="50*cm" y="50*cm" z="LFHCAL_length - LFHCALElectronicsThickness" />
      </eightmodule>
      <layer repeat="LFHCALLayer_NSteelRepeatSFirst" vis="InvisibleWithDaughters" readoutlayer="0">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatSFirst" vis="InvisibleWithDaughters" readoutlayer="1">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatS" vis="InvisibleWithDaughters" readoutlayer="2">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatS" vis="InvisibleWithDaughters" readoutlayer="3">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatS" vis="InvisibleWithDaughters" readoutlayer="4">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatS" vis="InvisibleWithDaughters" readoutlayer="5">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatSFirst" vis="InvisibleWithDaughters" readoutlayer="6">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeatSFirst" vis="InvisibleWithDaughters" readoutlayer="7">
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive="yes" limits="cal_limits" type="3" />
        <slice material="Kapton" thickness="LFHCALKaptonThickness" vis="LFHCALLayerKaptonVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
      </layer>

      <documentation>
        ### for testing of a single module
      </documentation>
      <eightmodulepositions>
        <position x="-100.94*mm" y="-50.5*mm" z="0*mm" orientation="2" IDx="0" IDy="0"/>
        <position x="-100.94*mm" y="-151.5*mm" z="0*mm" orientation="2" IDx="0" IDy="1"/>
        <position x="-100.94*mm" y="50.5*mm" z="0*mm" orientation="2" IDx="0" IDy="2"/>
        <position x="-100.94*mm" y="151.5*mm" z="0*mm" orientation="2" IDx="0" IDy="3"/>
        <position x="100.94*mm" y="-50.5*mm" z="0*mm" orientation="0" IDx="1" IDy="0"/>
        <position x="100.94*mm" y="-151.5*mm" z="0*mm" orientation="0" IDx="1" IDy="1"/>
        <position x="100.94*mm" y="50.5*mm" z="0*mm" orientation="0" IDx="1" IDy="2"/>
        <position x="100.94*mm" y="151.5*mm" z="0*mm" orientation="0" IDx="1" IDy="3"/>
      </eightmodulepositions>


      <documentation>
      ### positions of modules for full area LFHCAL (sorted by ascending x, y)
      </documentation>
      <fourmodulepositions>
      </fourmodulepositions>

    </detector>

  </detectors>

  <!--  Definition of the readout segmentation/definition  -->
  <readouts>
    <readout name="LFHCALHits">
      <segmentation type="NoSegmentation"/>
      <id>system:8,moduleIDx:4,moduleIDy:4,moduletype:1,passive:1,towerx:2,towery:1,rlayerz:6,layerz:6</id>
    </readout>
  </readouts>

</lccdd>
