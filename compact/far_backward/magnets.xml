<?xml version="1.0" encoding="UTF-8"?>
<lccdd>

<define>
   <constant name="Rreduction" value="4*mm"/>
   <constant name="Zreduction" value="0.5*mm"/>
   </define>

  <detectors>

    <comment> Magnet volumes </comment>

    <detector id="Magnet_Q1eR_ID" name="Magnet_Q1eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="0" y="0" z="Q1eR_CenterPosition" theta="0*rad"/>
      <dimensions x="Q1eR_InnerRadius*4" y="Q1eR_InnerRadius*4" z="Q1eR_Length" r="1.5*Q1eR_InnerRadius" />
      <apperture  x="Q1eR_InnerRadius*2" y="Q1eR_InnerRadius*2" r="Q1eR_InnerRadius" />
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_Q2eR_ID" name="Magnet_Q2eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="0" y="0" z="Q2eR_CenterPosition" theta="0*rad"/>
      <dimensions x="Q2eR_InnerRadius*4" y="Q2eR_InnerRadius*4" z="Q2eR_Length" r="1.5*Q2eR_InnerRadius"/>
      <apperture  x="Q2eR_InnerRadius*2" y="Q2eR_InnerRadius*2" r="Q2eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_B2AeR_ID" name="Magnet_B2AeR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="0" y="0" z="B2AeR_CenterPosition" theta="0*rad"/>
      <dimensions x="B2AeR_InnerRadius*4" y="B2AeR_InnerRadius*4" z="B2AeR_Length" r="1.5*B2AeR_InnerRadius"/>
      <apperture  x="B2AeR_InnerRadius*2" y="B2AeR_InnerRadius*2" r="B2AeR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_B2BeR_ID" name="Magnet_B2BeR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="0" y="0" z="B2BeR_CenterPosition" theta="0*rad"/>
      <dimensions x="B2BeR_InnerRadius*4" y="B2BeR_InnerRadius*4" z="B2BeR_Length" r="1.5*B2BeR_InnerRadius"/>
      <apperture  x="B2BeR_InnerRadius*2" y="B2BeR_InnerRadius*2" r="B2BeR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_Q3eR_ID" name="Magnet_Q3eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="(Q3eR_StartX+Q3eR_EndX)/2" y="0" z="(Q3eR_StartZ+Q3eR_EndZ)/2" theta="Q3eR_Theta"/>
      <dimensions x="0" y="0" z="Q3eR_Length" r="4*Q3eR_InnerRadius"/>
      <apperture  x="0" y="0" r="Q3eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>


    <detector id="Magnet_Q4eR_ID" name="Magnet_Q4eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="Q4eR_CenterX" y="0" z="Q4eR_CenterZ" theta="Q4eR_Theta"/>
      <dimensions x="0" y="0" z="Q4eR_Length" r="Q4eR_OuterRadius"/>
      <apperture  x="0" y="0" r="Q4eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_B3eR_ID" name="Magnet_B3eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="B3eR_CenterX" y="0" z="B3eR_CenterZ" theta="B3eR_Theta"/>
      <dimensions x="0" y="0" z="B3eR_Length" r="B3eR_OuterRadius"/>
      <apperture  x="0" y="0" r="B3eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_B4eR_ID" name="Magnet_B4eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="B4eR_CenterX" y="0" z="B4eR_CenterZ" theta="B4eR_Theta"/>
      <dimensions x="0" y="0" z="B4eR_Length" r="B4eR_OuterRadius"/>
      <apperture  x="0" y="0" r="B4eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>

    <detector id="Magnet_B5eR_ID" name="Magnet_B5eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="B5eR_CenterX" y="0" z="B5eR_CenterZ" theta="B5eR_Theta"/>
      <dimensions x="0" y="0" z="B5eR_Length" r="B5eR_OuterRadius"/>
      <apperture  x="0" y="0" r="B5eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>
    
    <detector id="Magnet_B6eR_ID" name="Magnet_B6eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="B6eR_CenterX" y="0" z="B6eR_CenterZ" theta="B6eR_Theta"/>
      <dimensions x="0" y="0" z="B6eR_Length" r="B6eR_OuterRadius"/>
      <apperture  x="0" y="0" r="B6eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>
    
    <detector id="Magnet_B7eR_ID" name="Magnet_B7eR" type="ip6_CylindricalDipoleMagnet" vis="FFMagnetVis">
      <placement  x="B7eR_CenterX" y="0" z="B7eR_CenterZ" theta="B7eR_Theta"/>
      <dimensions x="0" y="0" z="B7eR_Length" r="B7eR_OuterRadius"/>
      <apperture  x="0" y="0" r="B7eR_InnerRadius"/>
      <coil dx="2*cm" dy="1.5*cm" /><!--unchecked-->
    </detector>


    <comment> Inner vacuum for magnets </comment>

    <detector id="Pipe_to_Q1eR_ID" name="Pipe_to_Q1eR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="Q1eR_InnerRadius*2" outerD2="Center_Beampipe_Rad*2"
        end1z="Center_Beampipe_End" end2z="Q1eR_CenterPosition+Q1eR_Length/2"/>
    </detector>

    <detector id="Pipe_in_Q1eR_ID" name="Pipe_in_Q1eR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="Q1eR_InnerRadius*2" outerD2="Q1eR_InnerRadius*2"
        end1z="Q1eR_CenterPosition+Q1eR_Length/2" end2z="Q1eR_CenterPosition-Q1eR_Length/2"/>
    </detector>

    <detector id="Pipe_Q1eR_to_Q2eR_ID" name="Pipe_Q1eR_to_Q2eR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="Q2eR_InnerRadius*2" outerD2="Q1eR_InnerRadius*2"
        end1z="Q1eR_CenterPosition-Q1eR_Length/2" end2z="Q2eR_CenterPosition+Q2eR_Length/2"/>
    </detector>

    <detector id="Pipe_in_Q2eR_ID" name="Pipe_in_Q2eR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="Q2eR_InnerRadius*2" outerD2="Q2eR_InnerRadius*2"
        end1z="Q2eR_CenterPosition+Q2eR_Length/2" end2z="Q2eR_CenterPosition-Q2eR_Length/2"/>
    </detector>

    <detector id="Pipe_Q2eR_to_B2AeR_ID" name="Pipe_Q2eR_to_B2AeR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="B2AeR_InnerRadius*2" outerD2="Q2eR_InnerRadius*2"
        end1z="Q2eR_CenterPosition-Q2eR_Length/2" end2z="B2AeR_CenterPosition+B2AeR_Length/2"/>
    </detector>

    <detector id="Pipe_in_B2AeR_ID" name="Pipe_in_B2AeR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="B2AeR_InnerRadius*2" outerD2="B2AeR_InnerRadius*2"
        end1z="B2AeR_CenterPosition+B2AeR_Length/2" end2z="B2AeR_CenterPosition-B2AeR_Length/2"/>
    </detector>

    <detector id="Pipe_B2AeR_to_B2BeR_ID" name="Pipe_B2AeR_to_B2BeR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="B2BeR_InnerRadius*2" outerD2="B2AeR_InnerRadius*2"
        end1z="B2AeR_CenterPosition-B2AeR_Length/2" end2z="B2BeR_CenterPosition+B2BeR_Length/2"/>
    </detector>

    <detector id="Pipe_in_B2BeR_ID" name="Pipe_in_B2BeR" type="BackwardsBeamPipe">
      <Pipe wall_thickness="2*mm" outerD1="B2BeR_InnerRadius*2" outerD2="B2BeR_InnerRadius*2"
        end1z="B2BeR_CenterPosition+B2BeR_Length/2" end2z="B2BeR_CenterPosition-B2BeR_Length/2"/>
    </detector>


    <!-- Beam pipe going from Q3eR to B7eR -->
    <detector id="Pipe_Q3eR_to_B7eR_ID" name="Pipe_Q3eR_to_B7eR" type="FarBackwardsBeamPipes" wall_thickness="2*mm">
      <pipe id="0" name="Pipe_Q3eR"
        xcenter="Q3eR_XPosition" zcenter="Q3eR_CenterPosition" 
        length="Q3eR_Length" theta="Q3eR_Theta"
        rout1="Q3eR_InnerRadius" rout2="Q3eR_InnerRadius">
      </pipe>
      <pipe id="1" name="Pipe_Q3eR_to_Q4eR"
        xcenter="( Q3eR_XPosition - Q3eR_Length/2*sin(Q3eR_Theta) + Q4eR_CenterX + Q4eR_Length/2*sin(Q4eR_Theta) )/2" 
        zcenter="( Q3eR_CenterPosition - Q3eR_Length/2*cos(Q3eR_Theta) + Q4eR_CenterZ + Q4eR_Length/2*cos(Q4eR_Theta) )/2"
        length="sqrt( pow(Q3eR_XPosition - Q4eR_CenterX, 2) + pow(Q3eR_CenterPosition - Q4eR_CenterZ - (Q3eR_Length + Q4eR_Length)/2, 2) ) - 1*cm" 
        theta="atan( (Q3eR_XPosition - Q4eR_CenterX) / (Q3eR_CenterPosition - Q4eR_CenterZ - Q3eR_Length + Q4eR_Length) )"
        rout1="Q3eR_InnerRadius" rout2="Q4eR_InnerRadius">
      </pipe>
      <pipe id="2" name="Pipe_Q4eR"
        xcenter="Q4eR_CenterX" zcenter="Q4eR_CenterZ" 
        length="Q4eR_Length" theta="Q4eR_Theta"
        rout1="Q4eR_InnerRadius" rout2="Q4eR_InnerRadius">
      </pipe>
      <pipe id="3" name="Pipe_Q4eR_to_B3eR"
        xcenter="( Q4eR_CenterX - Q4eR_Length/2*sin(Q4eR_Theta) + B3eR_CenterX + B3eR_Length/2*sin(B3eR_Theta) )/2" 
        zcenter="( Q4eR_CenterZ - Q4eR_Length/2*cos(Q4eR_Theta) + B3eR_CenterZ + B3eR_Length/2*cos(B3eR_Theta) )/2"
        length="sqrt( pow(Q4eR_CenterX - B3eR_CenterX, 2) + pow(Q4eR_CenterZ - B3eR_CenterZ - (Q4eR_Length + B3eR_Length)/2, 2) )-1*cm" 
        theta="atan( (Q4eR_CenterX - B3eR_CenterX) / (Q4eR_CenterZ - B3eR_CenterZ - Q4eR_Length + B3eR_Length) )"
        rout1="Q4eR_InnerRadius" rout2="B3eR_InnerRadius">
      </pipe>
      <pipe id="4" name="Pipe_B3eR"
        xcenter="B3eR_CenterX" zcenter="B3eR_CenterZ" 
        length="B3eR_Length" theta="B3eR_Theta"
        rout1="B3eR_InnerRadius" rout2="B3eR_InnerRadius">
      </pipe>
      <pipe id="5" name="Pipe_B3eR_to_B4eR"
        xcenter="( B3eR_CenterX - B3eR_Length/2*sin(B3eR_Theta) + B4eR_CenterX + B4eR_Length/2*sin(B4eR_Theta) )/2" 
        zcenter="( B3eR_CenterZ - B3eR_Length/2*cos(B3eR_Theta) + B4eR_CenterZ + B4eR_Length/2*cos(B4eR_Theta) )/2"
        length="sqrt( pow(B3eR_CenterX - B4eR_CenterX, 2) + pow(B3eR_CenterZ - B4eR_CenterZ - (B3eR_Length+B4eR_Length)/2, 2) ) - 1*cm" 
        theta="atan( (B3eR_CenterX - B4eR_CenterX) / (B3eR_CenterZ - B4eR_CenterZ - B3eR_Length + B4eR_Length) )"
        rout1="B3eR_InnerRadius" rout2="B4eR_InnerRadius">
      </pipe>
      <pipe id="6" name="Pipe_B4eR"
        xcenter="B4eR_CenterX" zcenter="B4eR_CenterZ" 
        length="B4eR_Length" theta="B4eR_Theta"
        rout1="B4eR_InnerRadius" rout2="B4eR_InnerRadius">
      </pipe>
      <pipe id="7" name="Pipe_B4eR_to_B5eR"
        xcenter="( B4eR_CenterX - B4eR_Length/2*sin(B4eR_Theta) + B5eR_CenterX + B5eR_Length/2*sin(B5eR_Theta) )/2" 
        zcenter="( B4eR_CenterZ - B4eR_Length/2*cos(B4eR_Theta) + B5eR_CenterZ + B5eR_Length/2*cos(B5eR_Theta) )/2"
        length="sqrt( pow(B4eR_CenterX - B5eR_CenterX, 2) + pow(B4eR_CenterZ - B5eR_CenterZ - (B4eR_Length+B5eR_Length)/2, 2) ) - 1*cm" 
        theta="atan( (B4eR_CenterX - B5eR_CenterX) / (B4eR_CenterZ - B5eR_CenterZ - B4eR_Length + B5eR_Length) )"
        rout1="B4eR_InnerRadius" rout2="B5eR_InnerRadius">
      </pipe>
      <pipe id="8" name="Pipe_B5eR"
        xcenter="B5eR_CenterX" zcenter="B5eR_CenterZ" 
        length="B5eR_Length" theta="B5eR_Theta"
        rout1="B5eR_InnerRadius" rout2="B5eR_InnerRadius">
      </pipe>
      <pipe id="9" name="Pipe_B5eR_to_B6eR"
        xcenter="( B5eR_CenterX - B5eR_Length/2*sin(B5eR_Theta) + B6eR_CenterX + B6eR_Length/2*sin(B6eR_Theta) )/2" 
        zcenter="( B5eR_CenterZ - B5eR_Length/2*cos(B5eR_Theta) + B6eR_CenterZ + B6eR_Length/2*cos(B6eR_Theta) )/2"
        length="sqrt( pow(B5eR_CenterX - B6eR_CenterX, 2) + pow(B5eR_CenterZ - B6eR_CenterZ - (B5eR_Length+B6eR_Length)/2, 2) ) - 1*cm" 
        theta="atan( (B5eR_CenterX - B6eR_CenterX) / (B5eR_CenterZ - B6eR_CenterZ - B5eR_Length + B6eR_Length) )"
        rout1="B5eR_InnerRadius" rout2="B6eR_InnerRadius">
      </pipe>
      <pipe id="10" name="Pipe_B6eR"
        xcenter="B6eR_CenterX" zcenter="B6eR_CenterZ" 
        length="B6eR_Length" theta="B6eR_Theta"
        rout1="B6eR_InnerRadius" rout2="B6eR_InnerRadius">
      </pipe>
      <pipe id="11" name="Pipe_B6eR_to_B7eR"
        xcenter="( B6eR_CenterX - B6eR_Length/2*sin(B6eR_Theta) + B7eR_CenterX + B7eR_Length/2*sin(B7eR_Theta) )/2" 
        zcenter="( B6eR_CenterZ - B6eR_Length/2*cos(B6eR_Theta) + B7eR_CenterZ + B7eR_Length/2*cos(B7eR_Theta) )/2"
        length="sqrt( pow(B6eR_CenterX - B7eR_CenterX, 2) + pow(B6eR_CenterZ - B7eR_CenterZ - (B6eR_Length+B7eR_Length)/2, 2) ) - 1*cm" 
        theta="atan( (B6eR_CenterX - B7eR_CenterX) / (B6eR_CenterZ - B7eR_CenterZ - B6eR_Length + B7eR_Length) )"
        rout1="B6eR_InnerRadius" rout2="B7eR_InnerRadius">
      </pipe>
      <pipe id="12" name="Pipe_B7eR"
        xcenter="B7eR_CenterX" zcenter="B7eR_CenterZ" 
        length="B7eR_Length" theta="B7eR_Theta"
        rout1="B7eR_InnerRadius" rout2="B7eR_InnerRadius">
      </pipe> 
    </detector>


   
  </detectors>



  <fields>

    <comment> Magnetic fields </comment>

    <field name="Magnet_Q1eR_Field" type="MultipoleMagnet">
      <shape type="Tube" rmax="Q1eR_InnerRadius" dz="Q1eR_Length/2"/>
      <position x="0" y="0" z="Q1eR_CenterPosition"/>
      <coefficient/>
      <coefficient coefficient="-13.3153*tesla/meter"/>
    </field>

    <field name="Magnet_Q2eR_Field" type="MultipoleMagnet">
      <shape type="Tube" rmax="Q2eR_InnerRadius" dz="Q2eR_Length/2"/>
      <position x="0" y="0" z="Q2eR_CenterPosition"/>
      <coefficient/>
      <coefficient coefficient="12.0595*tesla/meter"/>
    </field>

    <field name="Magnet_Q3eR_Field" type="MultipoleMagnet">
      <shape type="Tube" rmax="Q3eR_InnerRadius" dz="Q3eR_Length/2"/>
      <position x="0" y="0" z="Q3eR_CenterPosition"/>
      <coefficient/>
      <coefficient coefficient="12.0595*tesla/meter"/>
    </field>

    <field name="Magnet_B2AeR_Field" type="MultipoleMagnet">
      <shape type="Tube" rmax="B2AeR_InnerRadius" dz="B2AeR_Length/2"/>
      <position x="0" y="0" z="B2AeR_CenterPosition"/>
      <coefficient coefficient="0.192*tesla"/>
    </field>

    <field name="Magnet_B2BeR_Field" type="MultipoleMagnet">
      <shape type="Tube" rmax="B2BeR_InnerRadius" dz="B2BeR_Length/2"/>
      <position x="0" y="0" z="B2BeR_CenterPosition"/>
      <coefficient coefficient="0.238*tesla"/>
    </field>

  </fields>

</lccdd>
